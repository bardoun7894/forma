 

## Brief
The client seeks a professional developer to build a comprehensive AI-powered website featuring video generation, professional image creation (e.g., Nano and Banana styles), AI avatar/portrait services for transforming user photos into characters, and optional content writing/transcription tools. The platform should mimic the ease of use of Flow while incorporating advanced capabilities similar to Runway, Pika, and Gemini. Key requirements include an attractive, user-friendly interface, user authentication and credit-based subscription system, integration with AI model APIs for images/videos/audio, a full admin dashboard for managing users, payments, and services, plus robust hosting, security, and speed optimization. The project aims for high professionalism with prior AI platform experience demonstrated through past work examples. This is a complex SaaS-like build with a $1,000 budget and 7-day timeline, indicating urgency but potential scope constraints.

(112 words)[^8_1]

## Questions for BA
1. What specific AI APIs or models do you prefer for video/image generation (e.g., RunwayML, Stable Diffusion, or custom integrations), and are there any existing APIs you want to use?
2. For the subscription system, what payment gateways are required (e.g., Stripe, PayPal), and how should credits/pricing tiers be structured for different services?
3. Can you provide more details on the admin dashboard features, such as user analytics, content moderation, or custom reporting needs?
4. What is the target audience size and expected traffic, and are there specific security/compliance requirements (e.g., GDPR for user data in avatars)?
5. Are there design preferences or wireframes for the UI, and what level of multilingual support (e.g., Arabic/English) is needed?[^8_1]

## Estimate
Time: 4–8 weeks (the 7-day timeline in the post seems unrealistic for a full AI platform; would require phased MVP delivery).  
Cost: $5,000–$15,000 (base $1,000 budget is too low for integrations and custom development; scalable based on scope clarification).[^8_1]

## Qualification
Warm (clear interest and detailed requirements show intent, but tight budget/timeline and need for examples suggest further discussion to align expectations and confirm viability).[^8_1]

Next steps: Reach out to the client to answer the BA questions above and share relevant portfolio samples from your AI SaaS projects to build trust. If qualified, proceed to detailed scoping.
<span style="display:none">[^8_2]</span>

<div align="center">⁂</div>

[^8_1]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA?deal_id=9436356#message9946346
[^8_2]: projects.saas_ai_multilingual_platform

---

# 1  we will use kie.ai   2 stripe check the best why like the apps mention credit 3  you choose 4 you check 5 arabic english

شكرًا على التوضيح، حدّثت الـ Intake بناءً على إجاباتك.[^9_1]

## Brief
العميل يريد منصة ويب احترافية للذكاء الاصطناعي تقدّم: توليد فيديوهات وصور، أفاتار وتحويل صور الشخصيات عبر برومبتات، مع نظام رصيد (Credits) شبيه بالتطبيقات المذكورة، ودعم لغتين: العربية والإنجليزية. سيتم الاعتماد على منصة kie.ai كنواة لخدمات الذكاء الاصطناعي، مع دمج بوابة دفع Stripe لإدارة الاشتراكات والرصيد. المطلوب لوحة تحكم إدارية لإدارة المستخدمين، الرصيد، المدفوعات، والخدمات، مع واجهة استخدام عصرية وسهلة. الهدف إطلاق منصة SaaS تجارية في وقت معقول مع إمكانية التوسع لاحقًا.[^9_2][^9_1]

## Questions for BA
1. ما هي أنواع الخدمات الدقيقة التي ستُفعّل من خلال kie.ai (فيديو، صور، أفاتار، تحويل صور، نصوص) وأيها أولوية للإصدار الأول (MVP)؟[^9_3][^9_2]
2. كيف تريد هيكلة نظام الرصيد (قيمة كل عملية فيديو/صورة/أفاتار بالرصيد، وهل هناك باقات شهرية ثابتة بالإضافة للرصيد؟).  
3. هل هناك متطلبات خاصة لتصميم الواجهة (شبيهة بمواقع معيّنة، ألوان، نمط UI/UX) أم يُترك ذلك للاقتراح؟  
4. ما هي المتطلبات القانونية/السياسات الخاصة باستخدام صور المستخدمين (سياسة خصوصية، Terms of Use) خاصة لخدمة تحويل الصور؟  
5. هل تحتاج لوحة تحكم منفصلة لدعم العملاء (Tickets/Chat) أم يكفي البريد/واتساب في المرحلة الأولى؟  

## Estimate
- الوقت: من 4 إلى 8 أسابيع لتطوير نسخة أولية قوية (MVP) مع: دمج kie.ai، Stripe، نظام رصيد، لوحة تحكم، ولغتين.[^9_4][^9_2]
- التكلفة: من 5,000 إلى 12,000 دولار تقريبًا، بحسب تفاصيل عدد الميزات في الإصدار الأول وحجم العمل على الواجهة ولوحة التحكم.[^9_5]

## Qualification
Warm → العميل واضح في طلبه، يعرف الأدوات (kie.ai، نظام رصيد، Stripe، لغتين)، ويبحث عن منصة احترافية، لكن ما زال يحتاج ضبط نطاق العمل (Scope) النهائي والاتفاق على ميزانية ومرحلية التنفيذ.[^9_1]
<span style="display:none">[^9_6]</span>

<div align="center">⁂</div>

[^9_1]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA?deal_id=9436356#message9946346
[^9_2]: https://firebase.google.com/docs/flutter/setup
[^9_3]: https://flutter.dev
[^9_4]: https://www.f22labs.com/blogs/how-to-integrate-firebase-with-flutter-7-simple-steps/
[^9_5]: https://nextnative.dev/alternatives/flutter-alternative
[^9_6]: projects.saas_ai_multilingual_platform

---

# need design to be like the company mention in the descripton

التصميم المطلوب يكون قريب جدًا من تجربة المنصات المذكورة في وصف المشروع مثل Flow (في سهولة الاستخدام) وRunway وPika وGemini (في الأسلوب البصري والاحترافية).[^10_1][^10_2]

## ما معنى “مثل الشركات المذكورة”؟

- واجهة نظيفة وبسيطة مع تركيز على معادلة: شاشة رئيسية تسوّق الخدمات + صفحة لكل خدمة (فيديو، صور، أفاتار…).[^10_2][^10_1]
- صفحات عرض الخدمة تحتوي: وصف مختصر، أمثلة قبل/بعد، حقل برومبت، إعدادات بسيطة (مدة الفيديو، نمط الصورة…) وزر “Generate”.[^10_3][^10_2]
- لوحة تسعير واضحة بنظام Credits مثل منصات الذكاء الاصطناعي (حزم رصيد بدل اشتراك ثابت فقط).[^10_4][^10_5]

## ما الذي تذكره للعميل في العرض؟

يمكنك توضيح ذلك في عرضك بهذه الصيغة تقريبًا (مع إعادة صياغة بسيطة عند اللزوم):

- ستصمّم واجهة modern شبيهة من حيث الفكرة وتجربة الاستخدام بالمنصات: Runway وPika وغيرها، مع تكييف الألوان والهوية حسب طلبه.[^10_1][^10_2]
- ستعتمد بنية صفحات تشبه منصات AI: صفحة رئيسية تسويقية، صفحات لكل خدمة، صفحة Pricing بنظام Credits، ولوحة Dashboard للمستخدم.[^10_6][^10_1]
- تذكر أن الهدف “تشابه في جودة وتجربة الاستخدام” وليس نسخًا حرفيًا للتصميم احترامًا للحقوق والهوية البصرية لكل منصة.[^10_7][^10_8]

إذا أحببت، أكتب لك الآن فقرة جاهزة بالعربية تضيفها مباشرة في عرضك توضّح نقطة “التصميم مثل الشركات المذكورة” بشكل احترافي.
<span style="display:none">[^10_10][^10_11][^10_12][^10_13][^10_14][^10_15][^10_16][^10_17][^10_18][^10_19][^10_20][^10_21][^10_9]</span>

<div align="center">⁂</div>

[^10_1]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA
[^10_2]: https://runwayml.com/product
[^10_3]: https://www.katalist.ai/post/best-ai-image-to-video
[^10_4]: https://kie.ai
[^10_5]: https://stripe.com/resources/more/pricing-flexibility-in-ai-services
[^10_6]: https://stripe.com/resources/more/credits-pricing-models-for-scaling-businesses-explained
[^10_7]: https://www.anchorline.tv/2024/using-ai-to-generate-full-motion-video/
[^10_8]: https://runwayml.com/research/introducing-runway-gen-4
[^10_9]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA?deal_id=9436356#message9946435
[^10_10]: https://mostaql.com/projects/skill/%D8%A7%D9%84%D8%B0%D9%83%D8%A7%D8%A1-%D8%A7%D9%84%D8%A7%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A
[^10_11]: https://mostaql.com/projects
[^10_12]: https://mostaql.com/projects/development
[^10_13]: https://academy.hsoub.com/programming/page/6/
[^10_14]: https://docs.stripe.com/billing/subscriptions/usage-based/use-cases/credits-based-pricing-model
[^10_15]: https://academy.hsoub.com/programming/general/%D9%85%D8%A7-%D9%87%D9%8A-%D8%A3%D9%83%D9%88%D8%A7%D8%AF-%D8%A7%D9%84%D8%A8%D8%B1%D9%85%D8%AC%D8%A9-r2244/
[^10_16]: https://www.youtube.com/watch?v=JzcxF137zts
[^10_17]: https://academy.hsoub.com/programming/os-embedded-systems/%D8%A3%D9%86%D9%88%D8%A7%D8%B9-%D8%A3%D9%86%D8%B8%D9%85%D8%A9-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84/
[^10_18]: https://academy.hsoub.com/programming/general/%D9%85%D8%A7-%D8%A3%D9%86%D9%88%D8%A7%D8%B9-%D8%A7%D9%84%D8%A3%D8%AE%D8%B7%D8%A7%D8%A1-%D8%A7%D9%84%D8%AA%D9%8A-%D8%AA%D8%B8%D9%87%D8%B1-%D8%B9%D9%84%D9%89-%D9%85%D9%88%D9%82%D8%B9-%D8%A5%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A%D8%8C-%D9%88%D9%83%D9%8A%D9%81-%D9%86%D8%AA%D8%B9%D8%A7%D9%85%D9%84-%D9%85%D8%B9%D9%87%D8%A7%D8%9F-r2417/
[^10_19]: https://academy.hsoub.com/programming/general/%D9%85%D8%B3%D8%AA%D9%88%D9%8A%D8%A7%D8%AA-%D9%84%D8%BA%D8%A7%D8%AA-%D8%A7%D9%84%D8%A8%D8%B1%D9%85%D8%AC%D8%A9/
[^10_20]: https://skywork.ai/skypage/en/Kie.ai-In-Depth-2025:-Your-Guide-to-Affordable,-Multi-Model-AI-API-Access/1976112870221082624
[^10_21]: https://www.youtube.com/watch?v=VfqScRRY02w

---

## User Stories

- US1: As a visitor, I want to generate AI videos from text or images so that I can quickly create professional video content without advanced editing skills.[^11_1][^11_2]
- US2: As a visitor, I want to generate high‑quality AI images in different styles (e.g., Nano, Banana) so that I can obtain unique visuals for my use cases.[^11_2][^11_1]
- US3: As a user, I want to upload my photos and generate multiple AI avatar/portrait variations so that I can use them on social media or branding.[^11_3][^11_1]
- US4: As a registered user, I want to buy credits or subscribe to a plan and see my remaining balance so that I can manage how much AI generation I can use.[^11_4][^11_1]
- US5: As an admin, I want to manage users, payments, and AI services from a dashboard so that I can control the platform, monitor usage, and handle issues.[^11_1][^11_4]
- US6: As a visitor, I want to experience a modern, simple UI similar in feel to major AI platforms so that I can quickly understand and use the services.[^11_5][^11_1]

## Acceptance Criteria

- AC1 (US1 – Video generation):  
  - User can select “Video” service from the homepage or dashboard.[^11_1]
  - User can enter a text prompt and optionally upload reference media.[^11_6][^11_2]
  - System sends a request to the configured kie.ai video model and shows status (queued, processing, done).[^11_7][^11_2]
  - On completion, user can preview, download, and see how many credits were deducted.[^11_2][^11_4]

- AC2 (US2 – Image generation):  
  - User can select “Image” service and choose a style (e.g., Nano, Banana).[^11_3][^11_1]
  - User enters a prompt and launches generation.[^11_2]
  - System displays a grid of generated images with options to download or regenerate.[^11_3][^11_2]
  - Credits deducted per generated batch and reflected in user balance.[^11_8][^11_4]

- AC3 (US3 – Avatar/Portrait):  
  - User can access an “Avatar / Portrait” page.[^11_1]
  - User uploads one or more photos within allowed formats and sizes.[^11_2]
  - System validates consent checkbox for using the photos in AI generation.[^11_1]
  - Platform generates multiple character variants and shows them in a gallery.[^11_6][^11_3]

- AC4 (US4 – Credits & subscriptions):  
  - User can view available plans and credit packs with clear pricing.[^11_4][^11_8]
  - User can pay via Stripe Checkout and, upon payment success, credits are added.[^11_9][^11_4]
  - Credit balance is visible in the header or account page and updates after each generation.[^11_10][^11_4]
  - If balance is insufficient, the system blocks generation and suggests buying credits.[^11_4]

- AC5 (US5 – Admin dashboard):  
  - Admin can log in through a secure admin portal.[^11_1]
  - Admin dashboard shows key metrics: new users, revenue, credit usage, top services.[^11_11][^11_9]
  - Admin can search/filter users, view their credit history, and manually adjust credits if needed.[^11_10][^11_4]
  - Admin can view logs of API calls to kie.ai for debugging and monitoring.[^11_12][^11_2]

- AC6 (US6 – UI/UX & languages):  
  - Site supports Arabic and English with an easy language switcher.[^11_1]
  - Layout and style feel modern and aligned with leading AI video/image platforms, without copying their designs.[^11_13][^11_5]
  - Key pages load quickly and are responsive on desktop and mobile.[^11_14][^11_2]

## Wireframe Request

Please provide or confirm wireframes/mockups for:  
- Homepage: hero section, service cards (Video, Image, Avatar, etc.), pricing teaser, and call‑to‑action.[^11_5][^11_1]
- Service detail pages:  
  - Video generation page (prompt input, settings, preview area).  
  - Image generation page (prompt, style selector, results grid).  
  - Avatar page (upload area, consent notice, generated gallery).[^11_15][^11_1]
- Pricing / Credits page: plans, credit packs, comparison, Stripe payment entry.[^11_8][^11_4]
- User dashboard: recent generations, credit balance, links to services.[^11_11][^11_2]
- Admin dashboard: metrics, user list, payments view, API usage logs.[^11_12][^11_2]

If no wireframes exist, a UX phase is recommended to design these screens before full development.

## Technical / Functional Questionnaire

Please confirm or specify the following:

- AI Services & Models  
  - Which kie.ai models should be used for:  
    - Video generation (e.g., Veo 3.1, Runway Aleph, Wan 2.5)?[^11_16][^11_6][^11_2]
    - Image generation (e.g., 4o Image or others)?[^11_2]
  - Any limits on resolution, duration, or number of outputs per request?

- Credits & Pricing  
  - Do you prefer pure credit‑based pricing, subscriptions with monthly credits, or a mix of both?[^11_8][^11_4]
  - How many credits should each action (video, image batch, avatar set) consume?  
  - Should credits expire after a timeframe?[^11_10][^11_4]

- Payments & Regions  
  - Which currencies and countries should Stripe support on the platform?[^11_9][^11_4]
  - Do you need invoicing, tax/VAT handling, or just simple card payments?

- Content & Policies  
  - Any restrictions on user content (e.g., NSFW, political, faces of minors) that must be enforced?[^11_1]
  - Do you already have Privacy Policy and Terms of Use texts, or should placeholders be added?

- Languages & Branding  
  - Final list of supported languages (currently Arabic and English).[^11_1]
  - Do you have a logo, color palette, and typography guidelines, or should the design team propose them?

- Infrastructure & Non‑Functional  
  - Preferred hosting stack (e.g., Vercel + managed DB + separate worker for long‑running jobs).  
  - Target uptime and performance expectations (e.g., 99.9% uptime, max response time for dashboard pages).[^11_2]
  - Any logging/monitoring tools required (e.g., Sentry, custom logs for kie.ai calls)?[^11_12][^11_2]

هذه المخرجات جاهزة للاستخدام كوثيقة BA أولية، ويمكن تطويرها أكثر بعد إجابات العميل على الأسئلة أعلاه.
<span style="display:none">[^11_17][^11_18][^11_19][^11_20][^11_21][^11_22][^11_23][^11_24][^11_25]</span>

<div align="center">⁂</div>

[^11_1]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA
[^11_2]: https://kie.ai
[^11_3]: https://kie.ai/market
[^11_4]: https://docs.stripe.com/billing/subscriptions/usage-based/use-cases/credits-based-pricing-model
[^11_5]: https://runwayml.com/product
[^11_6]: https://kie.ai/veo-3-1
[^11_7]: https://kie.ai/features/v3-api
[^11_8]: https://stripe.com/en-jp/resources/more/what-is-a-credits-based-subscription-model-and-how-does-it-work
[^11_9]: https://docs.stripe.com/products-prices/pricing-models
[^11_10]: https://docs.stripe.com/billing/subscriptions/usage-based/billing-credits
[^11_11]: https://stripe.com/resources/more/credits-pricing-models-for-scaling-businesses-explained
[^11_12]: https://kie.ai/changelog
[^11_13]: https://runwayml.com/research/introducing-runway-gen-4
[^11_14]: https://www.anchorline.tv/2024/using-ai-to-generate-full-motion-video/
[^11_15]: https://www.katalist.ai/post/best-ai-image-to-video
[^11_16]: https://kie.ai/wan-2-5
[^11_17]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA?deal_id=9436356#message9946538
[^11_18]: https://mostaql.com/projects/skill/%D8%A7%D9%84%D8%B0%D9%83%D8%A7%D8%A1-%D8%A7%D9%84%D8%A7%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A
[^11_19]: https://mostaql.com/projects
[^11_20]: https://mostaql.com/projects/development
[^11_21]: https://academy.hsoub.com/programming/page/6/
[^11_22]: https://academy.hsoub.com/programming/general/%D9%85%D8%A7-%D9%87%D9%8A-%D8%A3%D9%83%D9%88%D8%A7%D8%AF-%D8%A7%D9%84%D8%A8%D8%B1%D9%85%D8%AC%D8%A9-r2244/
[^11_23]: https://academy.hsoub.com/programming/os-embedded-systems/%D8%A3%D9%86%D9%88%D8%A7%D8%B9-%D8%A3%D9%86%D8%B8%D9%85%D8%A9-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84/
[^11_24]: https://academy.hsoub.com/programming/general/%D9%85%D8%A7-%D8%A3%D9%86%D9%88%D8%A7%D8%B9-%D8%A7%D9%84%D8%A3%D8%AE%D8%B7%D8%A7%D8%A1-%D8%A7%D9%84%D8%AA%D9%8A-%D8%AA%D8%B8%D9%87%D8%B1-%D8%B9%D9%84%D9%89-%D9%85%D9%88%D9%82%D8%B9-%D8%A5%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A%D8%8C-%D9%88%D9%83%D9%8A%D9%81-%D9%86%D8%AA%D8%B9%D8%A7%D9%85%D9%84-%D9%85%D8%B9%D9%87%D8%A7%D8%9F-r2417/
[^11_25]: https://academy.hsoub.com/programming/general/%D9%85%D8%B3%D8%AA%D9%88%D9%8A%D8%A7%D8%AA-%D9%84%D8%BA%D8%A7%D8%AA-%D8%A7%D9%84%D8%A8%D8%B1%D9%85%D8%AC%D8%A9/

---

# /PMAgent [requirements]
Role: Product/Project Manager Agent (PMAgent)
Mission: Turn the requirements document into project delivery plans.

Steps:
1. Review received requirements/user stories.
2. Divide features into releases (MVP, Full Prod, etc.).
3. Prepare a roadmap: major releases and milestones.
4. Draft sprint plan: group features by sprints, estimate using T-shirt sizing or story points.
5. Build RACI matrix: clarify roles (Responsible, Accountable, Consulted, Informed).
6. Make resource plan: map needed team/resources per phase.
7. List risks & mitigation strategies.
8. Output must be structured and action-oriented.

Output:
- Roadmap (timeline, releases)
- Sprint Plan (features per sprint, estimates)
- RACI Matrix (Who does what)
- Resource Plan (needed team, tools)
- Key Risks (with mitigation)

Tools: Planning heuristics, estimation models.

Format:
/PMAgent [Paste requirements or BRD here]

سيتم التعامل مع هذا المشروع عبر مراحل واضحة تبدأ من MVP ثم تطوير المنصة بالكامل، مع خطة سبرنتات، أدوار فريق، وتقييم مخاطر منظم.[^12_1][^12_2]

## Roadmap

- مرحلة 1 – Discovery & UX (1–2 أسابيع)  
  - مراجعة المتطلبات، إنهاء الأسئلة التقنية مع العميل، تصميم الـflows الأساسية والـwireframes.[^12_1]
- مرحلة 2 – MVP Release (4–6 أسابيع)  
  - خدمات أساسية: توليد فيديو وصور وأفاتار عبر kie.ai، نظام عضوية + رصيد + Stripe، لوحة تحكم مستخدم بسيطة، دعم عربي/إنجليزي.[^12_2][^12_3]
- مرحلة 3 – Full Product (4–6 أسابيع إضافية)  
  - تحسينات UI/UX، لوحات إحصائيات متقدمة، إدارة محتوى وتسويق، تحسين الأداء والمراقبة، توسعة الخدمات (موديلات إضافية).[^12_4][^12_5]
- مرحلة 4 – Optimization & Scaling (مستمرة)  
  - مراقبة الأداء، ضبط التكاليف، إضافة مزايا بناءً على استخدام العملاء.[^12_6][^12_2]

## Sprint Plan (مثال على 4 سبرنتات للمراحل الأولى)

- Sprint 1 (2 أسابيع)  
  - إعداد البنية التقنية (Repo, CI/CD، استضافة).  
  - إنشاء صفحات أساسية: Landing بسيطة، Auth (تسجيل/دخول)، Layout متعدد اللغات.[^12_2][^12_1]

- Sprint 2 (2 أسابيع)  
  - دمج Stripe (شراء رصيد/باقات) ونظام Credits (جداول، خصم عند الاستخدام).[^12_3][^12_6]
  - لوحة مستخدم: عرض الرصيد، آخر العمليات، إعدادات الحساب.[^12_3]

- Sprint 3 (2 أسابيع)  
  - تكامل خدمات kie.ai الأساسية:  
    - خدمة فيديو (نموذج واحد أساسي – مثلاً Veo 3.1).[^12_7][^12_2]
    - خدمة صور (نموذج Image).[^12_4][^12_2]
  - شاشات توليد: حقل برومبت، إعدادات بسيطة، عرض النتائج.  

- Sprint 4 (2 أسابيع)  
  - خدمة Avatar/Portrait (رفع صور + توليد شخصيات).[^12_8][^12_4]
  - لوحة Admin أولية: إدارة مستخدمين، أرصدة، ومراقبة الطلبات نحو kie.ai.[^12_5][^12_2]

(السبرنتات التالية تغطي الإحصائيات، التسويق، تحسين الأداء والـUX.)

## RACI Matrix (مبسّطة)

- Product Owner (أنت/العميل):  
  - R/A عن الرؤية، الأولويات، الموافقة على النطاق.  
- PM / Tech Lead:  
  - R عن التخطيط، تقسيم العمل، المتابعة اليومية.  
- Backend Engineer:  
  - R عن تكامل kie.ai، Stripe، نظام Credits، APIs.[^12_2][^12_3]
- Frontend Engineer:  
  - R عن الواجهة، الـLanding، صفحات الخدمات، لوحة المستخدم.[^12_1]
- UX/UI Designer:  
  - R عن wireframes، design system، التوافق مع تجربة منصات AI الكبرى.[^12_9]
- DevOps / Infra:  
  - R عن النشر، المراقبة، سجل الأخطاء، الأمان.[^12_10][^12_2]
- Legal/Compliance (استشاري):  
  - C حول سياسة الخصوصية واستخدام صور المستخدمين.[^12_1]

(Stakeholders الرئيسيون يكونون I – Informed بتقارير دورية.)

## Resource Plan

- فريق أساسي:  
  - 1 PM/Tech Lead (جزئي).  
  - 1 Backend (Node/Server + تكامل kie.ai/Stripe).[^12_3][^12_2]
  - 1 Frontend (Next.js أو إطار مناسب للويب الحديث).  
  - 1 UX/UI (في البداية + مراجعات دورية).  
  - 1 DevOps (جزئي – إعداد ونشر ومراقبة).[^12_2]

- أدوات أساسية:  
  - Kie.ai API (نماذج فيديو/صور/أفاتار).[^12_4][^12_2]
  - Stripe Billing / Credits Model.[^12_11][^12_3]
  - منصة استضافة (Vercel أو ما يعادله)، مراقبة (Sentry/Logs)، GitHub/GitLab.[^12_2]

## Key Risks & Mitigation

- خطر: تعقيد تكامل أكثر من نموذج AI (فيديو، صور، أفاتار) ضمن زمن قصير.  
  - Mitigation: البدء بنموذج واحد لكل نوع خدمة في الـMVP، ثم التوسع لاحقاً.[^12_12][^12_2]

- خطر: تكلفة استخدام النماذج أعلى من المتوقع مقارنة بسعر الباقات.  
  - Mitigation: تصميم نموذج Credits مرن، مراقبة التكاليف، ضبط دقة/مدة المخرجات.[^12_13][^12_3]

- خطر: توقعات عميل عالية جداً لتشابه كامل مع Runway/Pika خلال مدة قصيرة.  
  - Mitigation: توثيق واضح لما يشمله الـMVP مقابل الإصدارات اللاحقة، مع أمثلة وحدود.[^12_14][^12_9]

- خطر: مشكلات قانونية متعلقة بالصور الشخصية والأفاتار.  
  - Mitigation: إضافة موافقة صريحة، سياسة خصوصية واضحة، حظر بعض الاستخدامات.[^12_1]

يمكن استخدام هذا المخطط كخريطة تنفيذ عملية، وتعديله حسب حجم الفريق والميزانية الفعلية التي ستتفق عليها مع العميل.
<span style="display:none">[^12_15]</span>

<div align="center">⁂</div>

[^12_1]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA
[^12_2]: https://kie.ai
[^12_3]: https://docs.stripe.com/billing/subscriptions/usage-based/use-cases/credits-based-pricing-model
[^12_4]: https://kie.ai/market
[^12_5]: https://kie.ai/changelog
[^12_6]: https://docs.stripe.com/billing/subscriptions/usage-based/billing-credits
[^12_7]: https://kie.ai/veo-3-1
[^12_8]: https://kie.ai/wan-2-5
[^12_9]: https://runwayml.com/product
[^12_10]: https://academy.hsoub.com/programming/general/%D9%85%D8%A7-%D8%A3%D9%86%D9%88%D8%A7%D8%B9-%D8%A7%D9%84%D8%A3%D8%AE%D8%B7%D8%A7%D8%A1-%D8%A7%D9%84%D8%AA%D9%8A-%D8%AA%D8%B8%D9%87%D8%B1-%D8%B9%D9%84%D9%89-%D9%85%D9%88%D9%82%D8%B9-%D8%A5%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A%D8%8C-%D9%88%D9%83%D9%8A%D9%81-%D9%86%D8%AA%D8%B9%D8%A7%D9%85%D9%84-%D9%85%D8%B9%D9%87%D8%A7%D8%9F-r2417/
[^12_11]: https://stripe.com/en-jp/resources/more/what-is-a-credits-based-subscription-model-and-how-does-it-work
[^12_12]: https://kie.ai/features/v3-api
[^12_13]: https://stripe.com/resources/more/credits-pricing-models-for-scaling-businesses-explained
[^12_14]: https://runwayml.com/research/introducing-runway-gen-4
[^12_15]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA?deal_id=9436356#message9946538

---

# /DesignAgent [requirements]
Role: UX/UI Design Agent  
Mission: Generate high-quality UX flows, wireframes, and UI microcopy, **selecting color palette and visual style** suitable for the project.

Instructions:
1. **Analyze requirements/user stories** to identify all key screens and journeys.
2. **Choose a color palette:** Select 3–5 main colors and suggest their uses (primary, accent, background, alerts, etc.), considering branding and accessibility.
3. **Suggest a visual style/theme:** Describe overall look (e.g., modern, minimal, playful, professional, dark/light mode, etc.) and any relevant design inspiration.
4. **Draft a UX Flow Map:** List all user flows clearly.
5. **Wireframe Specs:** For each screen, specify components, layout, interactions, and hierarchical structure (JSON or descriptive list).
6. **Write microcopy:** Create UI text for buttons, forms, messages, tooltips, and empty states.
7. **Provide Figma-ready structure:** Export wireframes as JSON or organize content for direct Figma implementation.
8. **Add design highlights:** Note any accessibility considerations, motion/animation, and rationale behind color/style choices.

Output Sections:
- **Color Palette:** Swatches with roles (e.g., Primary: #3498db – Buttons, Accent: #f39c12 – Highlights).
- **Visual Style:** Short summary of look/feel, and design keywords.
- **UX Flow Map:** Steps/screens chart.
- **Wireframe Specs:** By screen/component, layout.
- **Microcopy:** UI text for each relevant element.
- **Design Highlights:** Accessibility, inspiration, rationale.
- **Figma/JSON Specs:** (If applicable)

Format:
/DesignAgent  
[Paste requirements or user stories here.  
e.g., "Dashboard, Orders Screen, Profile Edit, Support Chat"]
 should be simple as flow with the same design and like the other in features

المطلوب تصميم بسيط وواضح يحافظ على نفس نمط وتجربة المنصات المشابهة، مع المحافظة على نفس تدفّق الاستخدام والميزات الأساسية.[^13_1][^13_2]

## Color Palette
- Primary: #2563EB – للأزرار الرئيسية، الروابط البارزة، والعناصر التفاعلية الأساسية (شعور حديث واحترافي).[^13_2]
- Secondary: #0F172A – للعناوين والنصوص القوية، وخلفية بعض البلوكات الداكنة.[^13_2]
- Background: #0B0F19 (داكن) مع كتل #020617 و#111827 لطبقات الخلفية (إحساس منصات AI الحديثة).[^13_3][^13_2]
- Accent: #22C55E – للحالات الإيجابية، شارات “Active”، وأزرار نجاح.[^13_2]
- Alert: #F97316 (تحذير) و#EF4444 (أخطاء) للتنبيهات والرسائل.[^13_4]

## Visual Style
- نمط: Modern, Minimal, Dark UI، مستوحى من لوحات منصات الذكاء الاصطناعي (Runway / AI video tools) مع كروت، ظلال خفيفة، وأيقونات بسيطة.[^13_5][^13_2]
- كلمات مفتاحية: Cinematic, Futuristic, Clean, Focused.  

## UX Flow Map (مبسّط وواضح)
- Flow 1: Landing → Sign up / Login → Dashboard.[^13_1]
- Flow 2: Dashboard → اختيار خدمة (Video / Image / Avatar) → تعبئة البرومبت/رفع صورة → Generate → عرض النتيجة → Download / Save.[^13_6][^13_1]
- Flow 3: Dashboard → صفحة الرصيد/الاشتراك → اختيار باقة → Stripe Checkout → عودة مع رصيد محدث.[^13_7][^13_8]
- Flow 4: Dashboard → صفحة “مشاريعي” → عرض آخر المخرجات (فيديو/صور) مع إمكانية الفلترة والتنزيل.[^13_6]
- Flow 5: Admin → Login → لوحة تحكم → مستخدمون / عمليات / أرصدة / سجلات API.[^13_9][^13_6]

## Wireframe Specs (وصف لكل شاشة رئيسية)

1) Landing Page
- Header: شعار يسار، روابط (Features – Pricing – FAQ)، زر “تسجيل الدخول”، زر Primary “ابدأ الآن”.  
- Hero Section: عنوان قوي + وصف سطرين + زر “جرّب الآن” + خلفية مرئية (Mock أو صورة توضيحية).  
- Services Strip: ثلاث كروت أفقية (Video, Image, Avatar) كل كرت: أيقونة، عنوان، وصف قصير، زر “ابدأ”.[^13_1]
- How it works: 3 خطوات مرقّمة (اكتب برومبت → توليد → تحميل).  
- Pricing Preview: جدول بسيط 2–3 باقات بدون تفاصيل كاملة (رابط إلى صفحة التسعير).[^13_7]
- Footer: روابط (الشروط – الخصوصية – تواصل).  

2) Auth (Login/Signup)
- Card في وسط الصفحة، خلفية داكنة.  
- حقول: بريد/كلمة مرور، زر “تسجيل الدخول”، رابط “إنشاء حساب جديد”، رابط “نسيت كلمة المرور”.  

3) User Dashboard
- Sidebar: روابط (Dashboard, Video, Image, Avatar, Credits, Settings).  
- Main Area:  
  - أعلى: Welcome + ملخّص الرصيد (X Credits) + زر “اشترِ رصيدًا”.[^13_7]
  - أسفل: Cards لآخر المخرجات (شبكة مصغرات).[^13_6]

4) Service Page (مثال Video)
- Left Panel:  
  - Textarea للبرومبت.  
  - اختيار اللغة/نمط الفيديو (Drop-down بسيط).  
  - زر Primary “توليد الفيديو”.  
- Right Panel:  
  - Placeholder فارغ في البداية مع نص إرشادي.  
  - عند النتيجة: Video Player + أزرار (تحميل، إعادة التوليد).[^13_10][^13_6]

5) Pricing / Credits
- Plans Cards: كل كرت فيه اسم الباقة، عدد Credits، سعر، زر “شراء الآن”.[^13_11][^13_7]
- Section أسفل لأسئلة شائعة قصيرة حول الرصيد والاستخدام.  

6) Admin Dashboard
- Top Stats: 4 كروت (Users, Revenue, Credits used, API calls).[^13_9][^13_6]
- Tables:  
  - Users table (اسم، إيميل، رصيد، حالة).  
  - Transactions table (المستخدم، الباقة، Stripe ID، التاريخ).  

## Microcopy (نصوص واجهة مختصرة)

- زر التسجيل: “ابدأ الآن”  
- زر تسجيل الدخول: “تسجيل الدخول”  
- زر توليد الفيديو: “توليد الفيديو الآن”  
- Placeholder للبرومبت: “اكتب وصفًا واضحًا لما تريد توليده (مثال: فيديو مشهد سينمائي لمدينة مستقبلية ليلاً)...”  
- Empty state للنتائج: “لم تقم بتوليد أي مخرجات بعد. ابدأ بكتابة برومبت واضغط توليد.”  
- رسالة نجاح الدفع: “تمت إضافة الرصيد إلى حسابك بنجاح.”  
- رسالة رصيد غير كافٍ: “رصيدك غير كافٍ لهذه العملية. يرجى إعادة شحن الرصيد لإكمال الطلب.”  
- Tooltip للرصيد: “لكل عملية توليد يتم خصم عدد معيّن من الـ Credits حسب نوع الخدمة.”  

## Design Highlights

- Accessibility:  
  - تباين قوي بين النص والخلفية الداكنة، حجم خط لا يقل عن 14–16px، أزرار كبيرة وواضحة.[^13_4][^13_2]
  - استخدام أيقونات + نص في الأزرار لسهولة الفهم.  

- Motion/Animation:  
  - Transitions ناعمة عند hover على الكروت والأزرار.  
  - Skeleton loading عند انتظار نتائج الفيديو/الصور بدل شاشات فارغة.[^13_5]

- Rationale:  
  - Dark theme يعطي إحساس “AI / Pro / Cinematic” قريب من منصات الفيديو الذكية.[^13_3][^13_2]
  - Palette تعتمد الأزرق كـ Primary مع أخضر للرِضا/النجاح لإعطاء إحساس تقني وحديث.  

## Figma / JSON-ready Structure (مبسط)

يمكنك تنظيم الصفحات في Figma هكذا:  
- Pages:  
  - “01_Landing”  
  - “02_Auth”  
  - “03_Dashboard_User”  
  - “04_Service_Video / Image / Avatar”  
  - “05_Pricing”  
  - “06_Admin”  

وكل Page تحتوي Frames لـ Desktop (1440px) + Mobile (390px).[^13_2]

إذا أردت، يمكن توليد JSON تفصيلي لكل Frame (layers, components) لتستخدمه مباشرة في أدوات توليد التصميم أو Figma plugins.
<span style="display:none">[^13_12]</span>

<div align="center">⁂</div>

[^13_1]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA
[^13_2]: https://runwayml.com/product
[^13_3]: https://runwayml.com/research/introducing-runway-gen-4
[^13_4]: https://academy.hsoub.com/programming/general/%D9%85%D8%A7-%D8%A3%D9%86%D9%88%D8%A7%D8%B9-%D8%A7%D9%84%D8%A3%D8%AE%D8%B7%D8%A7%D8%A1-%D8%A7%D9%84%D8%AA%D9%8A-%D8%AA%D8%B8%D9%87%D8%B1-%D8%B9%D9%84%D9%89-%D9%85%D9%88%D9%82%D8%B9-%D8%A5%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A%D8%8C-%D9%88%D9%83%D9%8A%D9%81-%D9%86%D8%AA%D8%B9%D8%A7%D9%85%D9%84-%D9%85%D8%B9%D9%87%D8%A7%D8%9F-r2417/
[^13_5]: https://www.anchorline.tv/2024/using-ai-to-generate-full-motion-video/
[^13_6]: https://kie.ai
[^13_7]: https://docs.stripe.com/billing/subscriptions/usage-based/use-cases/credits-based-pricing-model
[^13_8]: https://docs.stripe.com/billing/subscriptions/usage-based/billing-credits
[^13_9]: https://kie.ai/changelog
[^13_10]: https://kie.ai/veo-3-1
[^13_11]: https://stripe.com/en-jp/resources/more/what-is-a-credits-based-subscription-model-and-how-does-it-work
[^13_12]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA?deal_id=9436356#message9946538

---

# /ArchAgent [requirements or design specs]
Role: Dev Architect Agent (ArchAgent)
Mission: Design and recommend a robust technical architecture for the given requirements.

Instructions:
1. **Analyze requirements/design specs:** Identify all main modules, integration points, and scalability needs.
2. **Propose system architecture:** 
   - Diagram components/services (e.g., frontend, backend, microservices, auth, data flows).
   - Choose stack: Recommend frameworks, languages, and tech for each layer—justify based on use case, scalability, and team skills.
3. **Database design:** Suggest DB type (SQL, NoSQL, graph), then present ERD (Entity Relationship Diagram) defining core tables/entities and their relations.
4. **API contracts:** Draft RESTful/OpenAPI spec covering endpoints, main request/response schemas, auth strategies, versioning.
5. **Add architecture diagrams:** (ASCII, Mermaid, or diagram descriptions—ready for tool import).
6. **Justify/Document decisions:** Note reasons for major choices, potential alternatives, and trade-offs.
7. **Highlight risk areas, integration concerns, and future extensibility.**

Output Sections:
- **System Architecture Overview:** Component diagram + description.
- **Tech Stack Choices:** List & justification per layer/service.
- **Database ERD:** Diagram or description of tables/entities.
- **API Spec:** OpenAPI-style endpoints, schemas, and flows.
- **Architecture Diagrams:** Visual/ASCII description or links.
- **Design Decisions & Risks:** Rationale, alternatives, key risks.
- **Notes:** Best practices, scaling strategy, integration highlights.

Tools: Templates, LLM, technology selection checklists.

Format:
/ArchAgent  
[Paste requirements or design specs here.  
مثال: "نظام إدارة مشاريع مع مستخدمين متعددين، صلاحيات، تقارير، تكامل دفع خارجي"]

سيتم تصميم معمارية تقنية متكاملة تعتمد على Frontend حديث، Backend قابل للتوسع، تكامل مع kie.ai وStripe، وقاعدة بيانات علائقية لإدارة المستخدمين والأرصدة والعمليات.[^14_1][^14_2][^14_3]

## System Architecture Overview
- مكونات أساسية:  
  - Frontend Web (Next.js أو إطار React SSR) لواجهة المستخدم بالعربية والإنجليزية.[^14_4][^14_1]
  - Backend API (Node.js/TypeScript) كطبقة BFF تتعامل مع قاعدة البيانات، Stripe، وkie.ai.[^14_2][^14_3]
  - Database (PostgreSQL) لتخزين المستخدمين، الرصيد، الطلبات، المخرجات، وسجلات الفوترة.[^14_3][^14_5]
  - Integration Layer مع kie.ai (SDK/HTTP) لخدمات الفيديو، الصور، الأفاتار.[^14_6][^14_2]
  - Payment Layer مع Stripe Billing + Credits Model.[^14_7][^14_3]
  - Background Worker/Queue (مثل BullMQ + Redis) لمعالجة مهام توليد الفيديو/الصور الطويلة.[^14_8][^14_2]
  - Admin Panel (يمكن أن تكون جزء من نفس Frontend مع صلاحيات خاصة).[^14_9][^14_2]

معمارية نصية (Mermaid-ready):
- Frontend → Backend API → DB  
- Backend API → Stripe API (Payments)  
- Backend API → Queue → Worker → kie.ai API → Callback/Status → DB → Frontend.[^14_2][^14_3][^14_6]

## Tech Stack Choices
- Frontend:  
  - Next.js + React + TypeScript، مع i18n لدعم العربية والإنجليزية، وTailwind CSS لتصميم Dark UI سريع.[^14_10][^14_4]
- Backend:  
  - Node.js + TypeScript + Framework مثل NestJS/Express، مع طبقة Services/Controllers واضحة.[^14_11][^14_12]
- Database:  
  - PostgreSQL (SQL) بسبب طبيعة الكيانات الواضحة (Users, Credits, Jobs) والحاجة لعلاقات واستعلامات قوية.[^14_5][^14_3]
- Auth:  
  - JWT-based أو Session-based (Cookies) مع دعم OAuth لاحقًا إن لزم.[^14_11]
- Payments:  
  - Stripe Billing + Credits Model (Usage-based/Prepaid) كما تقترح Stripe لموديل Credits.[^14_13][^14_3][^14_7]
- AI Integration:  
  - Kie.ai REST APIs / SDK لاختيار نماذج الفيديو (Veo 3.1, Wan 2.5) والصور والأفاتار.[^14_14][^14_6][^14_2]
- Infra:  
  - Frontend على Vercel أو ما يعادله، Backend + Worker على VPS/Container (Docker)، DB مُدارة (مثل managed Postgres)، مراقبة عبر Sentry/Logging.[^14_15][^14_2]

## Database ERD (مبسط)

كيانات رئيسية:
- Users  
  - id, email, password_hash, name, role(user/admin), locale, created_at.  
- CreditsWallet  
  - id, user_id(FK), balance, last_updated.[^14_3]
- CreditTransactions  
  - id, user_id(FK), amount(+/-), type(purchase/use/adjustment), stripe_payment_id, job_id(FK|null), created_at. [^14_3][^14_13]  
- Jobs  
  - id, user_id(FK), service_type(video/image/avatar), model_name, prompt, status(pending/running/done/failed), cost_credits, created_at, completed_at.[^14_6][^14_2]
- JobOutputs  
  - id, job_id(FK), output_url, thumbnail_url, metadata(JSON).[^14_2]
- Plans  
  - id, name, credits_amount, price, stripe_price_id, is_active.[^14_5][^14_3]

العلاقات:
- User 1–1 CreditsWallet  
- User 1–N CreditTransactions  
- User 1–N Jobs  
- Job 1–N JobOutputs  
- Plan 1–N CreditTransactions (type=purchase).  

## API Spec (مختصر بأسلوب OpenAPI)

- Auth  
  - POST /api/v1/auth/register  
  - POST /api/v1/auth/login  
  - GET /api/v1/auth/me  

- Credits & Plans  
  - GET /api/v1/plans  
  - POST /api/v1/checkout/session (body: plan_id) → returns Stripe Checkout URL.[^14_3][^14_5]
  - POST /api/v1/webhooks/stripe (Stripe webhook) → تحديث الرصيد عند النجاح.[^14_13][^14_3]
  - GET /api/v1/credits/balance  

- Jobs (AI Generation)  
  - POST /api/v1/jobs  
    - body: {service_type: "video"|"image"|"avatar", model, prompt, options, assets(optional)}  
    - logic: التحقق من الرصيد، خصم مبدئي/نهائي، إرسال للـQueue.[^14_6][^14_2]
  - GET /api/v1/jobs?service_type=&status=  
  - GET /api/v1/jobs/{id}  
  - GET /api/v1/jobs/{id}/outputs  

- Admin  
  - GET /api/v1/admin/dashboard/summary  
  - GET /api/v1/admin/users  
  - GET /api/v1/admin/credit-transactions  
  - GET /api/v1/admin/jobs  

Auth:  
- Bearer JWT / Cookies.  
- Admin routes تتطلب role=admin.  

## Architecture Diagram (ASCII)

- Client (Browser)  
  → Next.js (SSR/CSR)  
  → Backend API (Node.js/NestJS)  
    → PostgreSQL (Users, Credits, Jobs)  
    → Stripe API (Checkout, Webhooks)  
    → Redis Queue (Jobs Queue)  
        → Worker  
            → kie.ai API (Video/Image/Avatar Models)  
            → S3/Storage (حفظ المخرجات)  
    → Admin UI (نفس Next.js مع صلاحيات).[^14_2][^14_3][^14_6]

## Design Decisions & Risks

- اختيار PostgreSQL بدلاً من NoSQL لأن نمط البيانات علائقي ومستقر (Users, Payments, Jobs) ويتطلب استعلامات وتقارير قوية.[^14_5][^14_3]
- استخدام Queue/Worker ضروري لأن توليد الفيديو/الصور قد يكون بطيئاً ولا يناسب طلب HTTP متزامن.[^14_8][^14_2]
- الاعتماد على Stripe Credits Model يقلل التعقيد مقارنة ببناء نظام فوترة من الصفر، ويوفر مرونة عالية في الباقات.[^14_16][^14_3]
- المخاطر:  
  - تكاليف API من kie.ai إن لم تُضبط إعدادات الجودة/الطول. → حل: سقوف وحدود لكل نوع خدمة + مراقبة.[^14_17][^14_2]
  - تعقيد التعامل مع Webhooks (Stripe) وحالات الفشل. → حل: إعادة محاولات، سجلات دقيقة، Dashboard Admin.[^14_13][^14_3]

## Notes (Scaling & Best Practices)

- قابلية التوسع: فصل Backend API والWorker إلى خدمات مستقلة يمكن توسيعها أفقياً حسب حجم الوظائف.[^14_2]
- مراقبة: اعتماد Logging لطلبات kie.ai (request_id, model, latency, errors)، مع Dashboard Admin لعرض إحصائيات الاستخدام.[^14_9][^14_2]
- أمان:  
  - تخزين أقل قدر ممكن من بيانات المستخدم الحساسة، والاعتماد على Stripe للمدفوعات.[^14_3][^14_5]
  - حماية نقاط رفع الصور (Avatar) بفحص نوع وحجم الملف، ورفض المحتوى غير المسموح.[^14_1][^14_15]

يمكن استخدام هذا المخطط مباشرة كأساس لتوثيق معماري (ADR)، وتوسيعه حسب تفضيلك للـstack (مثلاً Supabase بدلاً من Postgres self-hosted لو أردت تسريع البداية).
<span style="display:none">[^14_18]</span>

<div align="center">⁂</div>

[^14_1]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA
[^14_2]: https://kie.ai
[^14_3]: https://docs.stripe.com/billing/subscriptions/usage-based/use-cases/credits-based-pricing-model
[^14_4]: https://runwayml.com/product
[^14_5]: https://docs.stripe.com/products-prices/pricing-models
[^14_6]: https://kie.ai/market
[^14_7]: https://stripe.com/en-jp/resources/more/what-is-a-credits-based-subscription-model-and-how-does-it-work
[^14_8]: https://www.anchorline.tv/2024/using-ai-to-generate-full-motion-video/
[^14_9]: https://kie.ai/changelog
[^14_10]: https://academy.hsoub.com/programming/general/%D9%85%D8%B3%D8%AA%D9%88%D9%8A%D8%A7%D8%AA-%D9%84%D8%BA%D8%A7%D8%AA-%D8%A7%D9%84%D8%A8%D8%B1%D9%85%D8%AC%D8%A9/
[^14_11]: https://academy.hsoub.com/programming/general/%D9%85%D8%A7-%D9%87%D9%8A-%D8%A3%D9%83%D9%88%D8%A7%D8%AF-%D8%A7%D9%84%D8%A8%D8%B1%D9%85%D8%AC%D8%A9-r2244/
[^14_12]: https://academy.hsoub.com/programming/os-embedded-systems/%D8%A3%D9%86%D9%88%D8%A7%D8%B9-%D8%A3%D9%86%D8%B8%D9%85%D8%A9-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84/
[^14_13]: https://docs.stripe.com/billing/subscriptions/usage-based/billing-credits
[^14_14]: https://kie.ai/veo-3-1
[^14_15]: https://academy.hsoub.com/programming/general/%D9%85%D8%A7-%D8%A3%D9%86%D9%88%D8%A7%D8%B9-%D8%A7%D9%84%D8%A3%D8%AE%D8%B7%D8%A7%D8%A1-%D8%A7%D9%84%D8%AA%D9%8A-%D8%AA%D8%B8%D9%87%D8%B1-%D8%B9%D9%84%D9%89-%D9%85%D9%88%D9%82%D8%B9-%D8%A5%D9%84%D9%83%D8%AA%D8%B1%D9%88%D9%86%D9%8A%D8%8C-%D9%88%D9%83%D9%8A%D9%81-%D9%86%D8%AA%D8%B9%D8%A7%D9%85%D9%84-%D9%85%D8%B9%D9%87%D8%A7%D8%9F-r2417/
[^14_16]: https://stripe.com/resources/more/credits-pricing-models-for-scaling-businesses-explained
[^14_17]: https://kie.ai/features/v3-api
[^14_18]: https://mostaql.com/project/1184219-%D8%B9%D9%85%D9%84-%D9%85%D9%88%D9%82%D8%B9-%D8%B0%D9%83%D8%A7%D8%A1-%D8%A5%D8%B5%D8%B7%D9%86%D8%A7%D8%B9%D9%8A-%D8%A5%D8%AD%D8%AA%D8%B1%D8%A7%D9%81%D9%8A-video-%D8%B5%D9%88%D8%B1-%D9%88%D8%AA%D8%AD%D9%88%D9%8A%D9%84-%D8%B5%D9%88%D8%B1-%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A7%D8%AA-%D9%85%D9%86-%D8%AE%D9%84%D8%A7%D9%84-%D8%A8%D8%B1%D9%88%D9%85%D8%AA%D8%A7%D8%AA?deal_id=9436356#message9946538

---

# /DevAgent [architecture specs or requirements]
Role: Developer Agent (DevAgent)
Mission: Generate initial code, create project skeleton, write endpoints, and produce basic unit tests based on architecture specifications.

Instructions:
1. **Analyze architecture specs:** Review system design, tech stack, database ERD, and API contracts to understand implementation requirements.
2. **Generate project skeleton:**
   - Create folder structure for chosen framework/stack.
   - Set up configuration files (package.json, requirements.txt, composer.json, etc.).
   - Initialize basic project structure with proper naming conventions.
3. **Write core endpoints:**
   - Implement main API endpoints based on OpenAPI spec.
   - Include authentication/authorization middleware.
   - Add input validation and error handling.
   - Follow RESTful conventions and best practices.
4. **Database implementation:**
   - Create migration files for database schema.
   - Write model/entity classes with relationships.
   - Include basic CRUD operations.
5. **Generate unit tests:**
   - Write test cases for main endpoints and business logic.
   - Include positive/negative test scenarios.
   - Set up testing framework configuration.
6. **Documentation & Git setup:**
   - Create README with setup instructions.
   - Prepare initial Git repository structure.
   - Generate basic API documentation.

Output Sections:
- **Project Structure:** Complete folder/file hierarchy.
- **Core Code Files:** Main application files with full implementation.
- **API Endpoints:** Complete endpoint implementations with routing.
- **Database Schema:** Migration files and model classes.
- **Unit Tests:** Test files covering main functionality.
- **Configuration:** Environment, dependencies, and setup files.
- **Documentation:** README, API docs, deployment notes.
- **Git Structure:** Branch strategy, commit templates, PR guidelines.

Tools: Code generation, repository access (Git), framework templates.

Format:
/DevAgent  
[Paste architecture specs or requirements here.  
مثال: "Laravel API with JWT auth, MySQL

سيتم توليد هيكل مشروع أولي (Backend) مبني على Node.js + NestJS + PostgreSQL مع نقاط بداية جاهزة لـ Stripe وkie.ai ويمكنك نسخه وتعديله في محررك.[^15_1][^15_2][^15_3]

## Project Structure (Backend – NestJS مثال)

- /project-root  
  - package.json  
  - nest-cli.json  
  - tsconfig.json  
  - .env.example  
  - /src  
    - main.ts  
    - app.module.ts  
    - /config (env, db, stripe, kie)  
    - /common (filters, guards, interceptors, dto base, utils)  
    - /auth (module, controller, service, jwt-strategy)  
    - /users (module, controller, service, entities, dtos)  
    - /credits (wallet + transactions)  
    - /plans  
    - /jobs (ai generation)  
    - /admin  
    - /webhooks (stripe)  
    - /database (migrations, seeds)  
  - /test (e2e + unit)[^15_3][^15_4][^15_5]

مثال package.json (مختصر):

```json
{
  "name": "ai-saas-backend",
  "version": "0.1.0",
  "scripts": {
    "start": "nest start",
    "start:dev": "nest start --watch",
    "test": "jest",
    "test:e2e": "jest --config ./test/jest-e2e.json",
    "migration:run": "npm run typeorm migration:run"
  },
  "dependencies": {
    "@nestjs/common": "^11.0.0",
    "@nestjs/core": "^11.0.0",
    "@nestjs/typeorm": "^11.0.0",
    "typeorm": "^0.3.20",
    "pg": "^8.13.0",
    "@nestjs/jwt": "^11.0.0",
    "passport": "^0.7.0",
    "@nestjs/passport": "^11.0.0",
    "stripe": "^16.0.0",
    "axios": "^1.7.0",
    "class-validator": "^0.14.0",
    "class-transformer": "^0.5.1"
  },
  "devDependencies": {
    "@nestjs/cli": "^11.0.0",
    "typescript": "^5.5.0",
    "jest": "^29.7.0",
    "@types/jest": "^29.5.0",
    "ts-jest": "^29.1.0",
    "@types/node": "^22.0.0"
  }
}
```


## Database Schema (TypeORM Entities + Migrations – مختصر)

مثال Entity للمستخدم:

```ts
// src/users/user.entity.ts
@Entity('users')
export class User {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @Column({ unique: true })
  email: string;

  @Column()
  passwordHash: string;

  @Column({ default: 'user' })
  role: 'user' | 'admin';

  @Column({ default: 'en' })
  locale: string;

  @CreateDateColumn()
  createdAt: Date;
}
```

محفظة الرصيد:

```ts
@Entity('credit_wallets')
export class CreditWallet {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @OneToOne(() => User, { onDelete: 'CASCADE' })
  @JoinColumn()
  user: User;

  @Column({ type: 'integer', default: 0 })
  balance: number;

  @UpdateDateColumn()
  updatedAt: Date;
}
```

معاملة رصيد/Stripe:

```ts
@Entity('credit_transactions')
export class CreditTransaction {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @ManyToOne(() => User, { onDelete: 'CASCADE' })
  user: User;

  @Column({ type: 'integer' })
  amount: number; // + أو -

  @Column()
  type: 'purchase' | 'use' | 'adjustment';

  @Column({ nullable: true })
  stripePaymentId: string;

  @Column({ nullable: true })
  jobId: string;

  @CreateDateColumn()
  createdAt: Date;
}
```

Jobs (AI):

```ts
@Entity('jobs')
export class Job {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @ManyToOne(() => User, { onDelete: 'CASCADE' })
  user: User;

  @Column()
  serviceType: 'video' | 'image' | 'avatar';

  @Column()
  modelName: string;

  @Column({ type: 'text' })
  prompt: string;

  @Column({ default: 'pending' })
  status: 'pending' | 'running' | 'done' | 'failed';

  @Column({ type: 'integer', default: 0 })
  costCredits: number;

  @CreateDateColumn()
  createdAt: Date;

  @Column({ type: 'timestamptz', nullable: true })
  completedAt: Date | null;
}
```

مهاجرات يمكن توليدها من هذه الكيانات باستخدام CLI لـ TypeORM/NestJS.[^15_2][^15_3]

## Core API Endpoints (NestJS Controllers – أمثلة)

AuthController:

```ts
// src/auth/auth.controller.ts
@Controller('api/v1/auth')
export class AuthController {
  constructor(private readonly authService: AuthService) {}

  @Post('register')
  async register(@Body() dto: RegisterDto) {
    return this.authService.register(dto);
  }

  @Post('login')
  async login(@Body() dto: LoginDto) {
    return this.authService.login(dto);
  }

  @Get('me')
  @UseGuards(JwtAuthGuard)
  me(@Req() req: any) {
    return req.user;
  }
}
```

JobsController (إنشاء Job مع خصم الرصيد وإرسال للـWorker):

```ts
// src/jobs/jobs.controller.ts
@UseGuards(JwtAuthGuard)
@Controller('api/v1/jobs')
export class JobsController {
  constructor(private readonly jobsService: JobsService) {}

  @Post()
  createJob(@Body() dto: CreateJobDto, @Req() req: any) {
    return this.jobsService.createJob(req.user.id, dto);
  }

  @Get()
  findAll(@Req() req: any, @Query('serviceType') serviceType?: string) {
    return this.jobsService.findAllForUser(req.user.id, serviceType);
  }

  @Get(':id')
  findOne(@Req() req: any, @Param('id') id: string) {
    return this.jobsService.findOneForUser(req.user.id, id);
  }
}
```

JobsService (منطق أساسي):

```ts
// src/jobs/jobs.service.ts
@Injectable()
export class JobsService {
  constructor(
    @InjectRepository(Job) private readonly jobRepo: Repository<Job>,
    private readonly creditsService: CreditsService,
    private readonly queueService: QueueService,
  ) {}

  async createJob(userId: string, dto: CreateJobDto) {
    const estimatedCost = this.creditsService.estimateCost(dto);
    await this.creditsService.ensureBalance(userId, estimatedCost);

    const job = this.jobRepo.create({
      user: { id: userId } as any,
      serviceType: dto.serviceType,
      modelName: dto.modelName,
      prompt: dto.prompt,
      status: 'pending',
      costCredits: estimatedCost,
    });
    const saved = await this.jobRepo.save(job);

    await this.creditsService.reserveCredits(userId, estimatedCost, saved.id);
    await this.queueService.enqueueJob(saved);

    return saved;
  }
}
```

Stripe Webhook مثال:

```ts
// src/webhooks/stripe.controller.ts
@Controller('api/v1/webhooks/stripe')
export class StripeWebhookController {
  @Post()
  async handle(@Req() req: any, @Headers('stripe-signature') sig: string) {
    // تحقق من التوقيع عبر Stripe SDK
    // عند payment_intent.succeeded → إضافة CreditsTransaction + تحديث wallet
  }
}
```


## Unit Tests (Jest – مثال بسيط)

```ts
// test/jobs.service.spec.ts
describe('JobsService', () => {
  let service: JobsService;

  it('should create job when user has enough credits', async () => {
    // mock creditsService.ensureBalance → لا يرمي خطأ
    // mock jobRepo.save → يعيد job
    // توقّع أن queueService.enqueueJob تم استدعاؤه
  });

  it('should throw when credits are insufficient', async () => {
    // mock creditsService.ensureBalance → يرمي Error
    // توقّع أن createJob يرمي نفس الخطأ
  });
});
```


## Configuration \& README (مختصر)

- .env.example:
    - DATABASE_URL=postgres://…
    - JWT_SECRET=…
    - STRIPE_SECRET_KEY=…
    - STRIPE_WEBHOOK_SECRET=…
    - KIE_API_KEY=…[^15_6][^15_7]

README:

- خطوات:
    - git clone
    - npm install
    - إعداد .env
    - تشغيل migrations
    - npm run start:dev


## Git Structure (اقتراح سريع)

- main: إنتاج
- develop: تطوير
- feature/* لكل ميزة (auth, jobs, credits, admin…)
- PR template بسيط يطلب: وصف، خطوات اختبار، تغييرات على DB، ملاحظات.[^15_8][^15_5]

هذا يعطّيك Skeleton عملي قابل للتوسّع، وتقدر الآن تطلب توليد ملفات محددة (مثلاً: كامل auth module، أو كل DTOs والـEntities) وسأكملها لك بما يناسب مشروعك.
<span style="display:none">[^15_10][^15_11][^15_12][^15_13][^15_14][^15_15][^15_16][^15_17][^15_18][^15_19][^15_20][^15_21][^15_22][^15_23][^15_24][^15_9]</span>

<div align="center">⁂</div>

[^15_1]: https://dev.to/tak089/nestjs-roadmap-for-2025-5jj

[^15_2]: https://docs.nestjs.com/first-steps

[^15_3]: https://www.geeksforgeeks.org/javascript/folder-structure-of-a-nestjs-project/

[^15_4]: https://www.linkedin.com/posts/shantanu-maske-tech_nestjs-meanstack-nodejs-activity-7361018218192236545-L852

[^15_5]: https://vivasoftltd.com/node-js-project-architecture-best-practices/

[^15_6]: https://docs.stripe.com/billing/subscriptions/usage-based/use-cases/credits-based-pricing-model

[^15_7]: https://kie.ai

[^15_8]: https://www.reddit.com/r/node/comments/1mgjrfa/advanced_nodejs_project_structure/

[^15_9]: https://mostaql.com/project/1184219-عمل-موقع-ذكاء-إصطناعي-إحترافي-video-صور-وتحويل-صور-لشخصيات-من-خلال-برومتات?deal_id=9436356\#message9946538

[^15_10]: https://leapcell.io/blog/nestjs-2025-backend-developers-worth-it

[^15_11]: https://www.youtube.com/watch?v=67SRr5cLmQA

[^15_12]: https://www.tigerdata.com/blog/we-taught-ai-to-write-real-postgres-code-open-sourced-it

[^15_13]: https://www.wisp.blog/blog/integration-of-stripe-subscription-with-nextjs-14-application

[^15_14]: https://pgmodeler.io

[^15_15]: https://www.shoaibsid.dev/blog/nestjs-in-2025-the-new-node-js-framework-everyones-talking-about-but-is-it-worth-learning

[^15_16]: https://kitemetric.com/blogs/seamless-stripe-integration-for-your-next-js-saas-a-step-by-step-guide

[^15_17]: https://www.geeksforgeeks.org/postgresql/finding-the-best-ai-for-postgresql-database/

[^15_18]: https://www.reddit.com/r/nextjs/comments/1g3lwxd/integrating_stripe_with_nextjs_a_comprehensive/

[^15_19]: https://codegpt.co/agents/postgresql

[^15_20]: https://vercel.com/kb/guide/getting-started-with-nextjs-typescript-stripe

[^15_21]: https://chartdb.io

[^15_22]: https://docs.stripe.com/financial-accounts/connect/examples/sample-app

[^15_23]: https://dev.to/njabulomajozi/ai-powered-postgresql-test-data-generation-tool-cloudflare-ai-challenge-4572

[^15_24]: https://docs.stripe.com/billing/subscriptions/usage-based/billing-credits


---

# /OpsAgent [project specs or tech stack]

Role: CI/CD \& DevOps Agent (OpsAgent)
Mission: Automate deployment environment setup, generate CI pipelines (YAMLs), create infrastructure-as-code templates, and configure basic monitoring.

Instructions:

1. **Review project specs and tech stack:** Identify application type, environments (staging, production), deployment platforms, and dependencies.
2. **Setup infrastructure-as-code:**
    - Generate Terraform scripts for resources (servers, DBs, buckets, firewalls).
    - Provide Kubernetes manifests for services, deployments, ingress, secrets.
3. **CI/CD pipelines:**
    - Write GitHub Actions (or GitLab CI) YAML workflows for build, test, security scan, and deploy.
    - Include environment variables, secrets management, and rollback/retry logic.
4. **Deployment logic:**
    - Detail workflow for staging \& production: steps, approvals, rollbacks.
    - Automate Docker builds and images.
    - Set up artifact/versioning and tagging conventions.
5. **Monitoring basics:**
    - Add scripts/config for health checks, uptime monitors, basic alerting (Prometheus, Grafana, etc.).
    - Recommend/activate log aggregation strategy.
6. **Documentation \& best practices:**
    - Provide README/setup notes for infra, pipeline usage, and operational handoff.
    - Summarize backup, scaling, and failover strategies.

Output Sections:

- **Terraform/IaC scripts:** Infrastructure code for quick provisioning.
- **Kubernetes manifests:** Deployments, services, ingress, config.
- **CI/CD Workflows:** YAML files for pipeline automation.
- **Deployment Logic:** Steps for staging/prod + rollback/control.
- **Monitoring Setup:** Health check configs, alert basics.
- **Documentation:** Integration/config notes, troubleshooting guide.

Tools: Terraform, Kubernetes manifests, GitHub Actions, monitoring templates.

Format:
/OpsAgent

سيتم تجهيز بنية DevOps كاملة مبنية على Docker + Kubernetes + Terraform + GitHub Actions، مع بيئتين (Staging/Production) وتكامل مع الـBackend الحالي (NestJS + Postgres) لتسهيل النشر والتوسّع.[^16_1][^16_2][^16_3]

## Terraform / IaC (ملخّص)

- موارد مقترحة (يمكن تكييفها لأي Cloud: Contabo, AWS, GCP):
    - VPC + Subnets خاصة للعقد.[^16_4]
    - Kubernetes Cluster (Managed أو K3s على VPS).
    - Managed PostgreSQL DB.[^16_5]
    - Object Storage (S3-compatible) لملفات الفيديو/الصور.[^16_6]
    - Load Balancer خارجي (لـIngress).

أمثلة modules:

- terraform/main.tf
    - provider "aws"/"hcloud"/...
    - module "k8s_cluster"
    - module "postgres"
    - module "storage"

هذا يسهّل إعادة إنشاء البنية من الصفر لأي بيئة.[^16_7][^16_8]

## Kubernetes Manifests (مختصر)

- Namespaces:
    - formaai-staging
    - formaai-prod
- Deployments/Services:
    - api-deployment (NestJS) + api-service (ClusterIP).[^16_2][^16_9]
    - worker-deployment (Queue Worker).
    - ingress-nginx أو Traefik: ingress للـapi والـfrontend (Next.js لو استضفته على نفس الكلاستر).[^16_4]

مثال مبسّط لـDeployment للـAPI:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: api
  namespace: formaai-prod
spec:
  replicas: 3
  selector:
    matchLabels:
      app: api
  template:
    metadata:
      labels:
        app: api
    spec:
      containers:
        - name: api
          image: registry.example.com/formaai/api:latest
          envFrom:
            - secretRef:
                name: api-secrets
          ports:
            - containerPort: 3000
          readinessProbe:
            httpGet:
              path: /health
              port: 3000
            initialDelaySeconds: 10
            periodSeconds: 10
          livenessProbe:
            httpGet:
              path: /health
              port: 3000
            initialDelaySeconds: 30
            periodSeconds: 20
```

Secret مثال:

- STRIPE_SECRET_KEY
- STRIPE_WEBHOOK_SECRET
- KIE_API_KEY
- DATABASE_URL

تُدار كـKubernetes Secrets وترتبط بالـPods.[^16_10][^16_11]

## CI/CD Workflows (GitHub Actions – ملخص)

ملفان رئيسيان:

- .github/workflows/ci.yml
    - Trigger: push/PR على main/develop.
    - Jobs:
        - Install deps
        - Run lint + tests (backend + frontend إن وجد)
        - Build Docker images (tag: sha + branch) بدون نشر.[^16_12][^16_7]
- .github/workflows/cd.yml
    - Trigger: tag release أو push على main.
    - Jobs:
        - Build \& push Docker images إلى registry.
        - kubectl apply -f k8s/*.yaml للبيئة المستهدفة (staging/prod) باستخدام kubeconfig/OIDC.[^16_3][^16_13]

نموذج خطوة Stripe/K8S secret في GitHub Actions:

```yaml
env:
  REGISTRY: ghcr.io/your-org/formaai
  IMAGE_TAG: ${{ github.sha }}

- name: Build & Push API image
  run: |
    docker build -t $REGISTRY/api:$IMAGE_TAG -f backend/Dockerfile backend
    echo $CR_PAT | docker login ghcr.io -u $GITHUB_ACTOR --password-stdin
    docker push $REGISTRY/api:$IMAGE_TAG
```


## Deployment Logic

- Staging:
    - Trigger: push إلى develop أو tag pre-release.
    - Steps: build → push image:staging-sha → apply k8s-staging manifests (imagePullPolicy: Always).
    - Approval: تلقائي، يستخدم لعرض النسخة للعميل والاختبار.
- Production:
    - Trigger: tag vX.Y.Z على main.
    - Requires: manual approval (GitHub Environments).[^16_3]
    - Steps: build → push image:prod-vX.Y.Z → apply k8s-prod manifests.
    - Rollback: تغيير deployment image إلى آخر tag مستقر وإعادة deploy (kubectl rollout undo).[^16_4]

Convention:

- Branches: main (prod), develop (staging), feature/*
- Tags: v1.0.0, v1.0.1…


## Monitoring Setup

- Health Checks:
    - /health endpoint في NestJS للـAPI والـWorker.[^16_9]
- Metrics:
    - استخدام Prometheus + Grafana أو خدمة مستضافة (Grafana Cloud, APM).[^16_14][^16_4]
    - جمع:
        - Latency للـAPI
        - عدد jobs per service_type
        - استهلاك credits/دقيقة/ساعة
- Logs:
    - جمع logs إلى Loki/ELK أو خدمة مثل Logtail/Datadog (اختيار واحد حسب الميزانية).[^16_14]
    - مهم لمراقبة أخطاء kie.ai, Stripe, DB.[^16_11][^16_15]


## Documentation (Ops)

- README-ops.md:
    - كيف:
        - تشغيل Terraform بالأوامر init/plan/apply لكل بيئة.[^16_7]
        - إعداد kubeconfig واستخدام kubectl.
        - متغيرات البيئة اللازمة لكل بيئة (STAGING_*, PROD_*).
        - كيفية تفعيل/تعطيل auto-deploy من GitHub Actions.[^16_3]
- Backup \& Scaling:
    - PostgreSQL: snapshots يومية + PITR إن أمكن.[^16_16][^16_5]
    - Object Storage: نسخة احتياطية دورية للـbucket.[^16_6]
    - Scaling:
        - Auto-scaling للـAPI والـWorker اعتماداً على CPU/queue length.[^16_4]
        - فصل Worker عن API ليتمكن من التوسع بشكل مستقل عند ضغط jobs فيديو.[^16_11][^16_6]

بهذه الخطة، سيكون لديك مسار DevOps واضح من الكود حتى الإنتاج مع نشر آلي، مراقبة أساسية، وبنية يمكن تطويرها لاحقاً بسهولة.
<span style="display:none">[^16_17][^16_18]</span>

<div align="center">⁂</div>

[^16_1]: https://dev.to/tak089/nestjs-roadmap-for-2025-5jj

[^16_2]: https://www.geeksforgeeks.org/javascript/folder-structure-of-a-nestjs-project/

[^16_3]: https://vercel.com/kb/guide/getting-started-with-nextjs-typescript-stripe

[^16_4]: https://academy.hsoub.com/programming/os-embedded-systems/أنواع-أنظمة-التشغيل/

[^16_5]: https://pgmodeler.io

[^16_6]: https://www.anchorline.tv/2024/using-ai-to-generate-full-motion-video/

[^16_7]: https://vivasoftltd.com/node-js-project-architecture-best-practices/

[^16_8]: https://chartdb.io

[^16_9]: https://docs.nestjs.com/first-steps

[^16_10]: https://docs.stripe.com/billing/subscriptions/usage-based/billing-credits

[^16_11]: https://kie.ai

[^16_12]: https://www.reddit.com/r/node/comments/1mgjrfa/advanced_nodejs_project_structure/

[^16_13]: https://kitemetric.com/blogs/seamless-stripe-integration-for-your-next-js-saas-a-step-by-step-guide

[^16_14]: https://academy.hsoub.com/programming/general/ما-أنواع-الأخطاء-التي-تظهر-على-موقع-إلكتروني،-وكيف-نتعامل-معها؟-r2417/

[^16_15]: https://docs.stripe.com/billing/subscriptions/usage-based/use-cases/credits-based-pricing-model

[^16_16]: https://www.geeksforgeeks.org/postgresql/finding-the-best-ai-for-postgresql-database/

[^16_17]: https://mostaql.com/project/1184219-عمل-موقع-ذكاء-إصطناعي-إحترافي-video-صور-وتحويل-صور-لشخصيات-من-خلال-برومتات?deal_id=9436356\#message9946538

[^16_18]: https://www.youtube.com/watch?v=67SRr5cLmQA


---

## Test Plan

- Objectives:
    - التحقق من أن منصة الذكاء الاصطناعي (فيديو، صور، أفاتار) تعمل وفق المتطلبات، مع نظام رصيد/Stripe، وتكامل kie.ai، وواجهات عربية/إنجليزية.[^17_1][^17_2]
    - تغطية الوظائف الأساسية (تسجيل، شراء رصيد، توليد مخرجات، إدارة) بالإضافة للتكاملات (Stripe، kie.ai) وتجربة المستخدم.[^17_3][^17_4]
- Scope:
    - Functional: Auth, Dashboard, Jobs (video/image/avatar), Credits, Plans, Admin.[^17_2][^17_1]
    - Integration: Stripe Test Mode، kie.ai Sandbox/keys.[^17_4][^17_3][^17_2]
    - Regression: كل الفلوهات الحرجة عند كل إصدار.
    - Performance (أساسي): زمن الاستجابة للـAPI والـUI لسيناريوهات عادية.[^17_5]
- Test Types Matrix (ملخص):
    - Auth \& Users → Functional, Security, Regression.
    - Credits \& Stripe → Functional, Integration, Negative.[^17_6][^17_3]
    - Jobs (AI) → Functional، Integration (kie.ai)، Error handling.[^17_7][^17_2]
    - UI/UX Flows → E2E (Playwright), Usability smoke.[^17_8][^17_5]


## Test Cases (نماذج رئيسية)

1) Auth – تسجيل مستخدم جديد

- Steps: فتح صفحة التسجيل → إدخال بيانات صحيحة → إرسال.
- Expected: إنشاء حساب، تحويل للـDashboard، محفظة رصيد فارغة.
- Priority: High – Critical path.

2) Stripe – شراء باقة رصيد بنجاح

- Steps: من Dashboard → صفحة Pricing → اختيار باقة → الانتقال لStripe Test → استخدام بطاقة اختبار → العودة للموقع.[^17_3][^17_4]
- Expected: حالة الدفع “succeeded”، إضافة CreditsTransaction وإضافة الرصيد لمحفظة المستخدم، ظهور إشعار نجاح.
- Priority: High.

3) Stripe – فشل الدفع (بطاقة مرفوضة)

- Steps: نفس السيناريو مع بطاقة مرفوضة Test Card.[^17_6][^17_3]
- Expected: عدم إضافة رصيد، رسالة خطأ واضحة للمستخدم.
- Priority: High.

4) Create Video Job – رصيد كافٍ

- Steps: مستخدم لديه رصيد كافٍ → صفحة Video → إدخال برومبت → Generate.
- Expected: إنشاء Job بحالة pending → إرسال طلب للـqueue/kie.ai → تحديث الحالة إلى done → ظهور الفيديو وإمكانية التحميل، خصم الرصيد.[^17_9][^17_2]
- Priority: High.

5) Create Video Job – رصيد غير كافٍ

- Expected: رفض العملية برسالة “رصيد غير كافٍ”، دون إنشاء Job أو خصم.[^17_10][^17_11]
- Priority: High.

6) Avatar Generation – رفع صورة غير صالحة

- Steps: رفع ملف غير صورة أو حجم كبير جدًا.
- Expected: رسالة خطأ Validation، لا يُرسل أي طلب لـkie.ai.[^17_12][^17_2]
- Priority: Medium.

7) Admin Dashboard – عرض ملخص النظام

- Steps: تسجيل دخول كـadmin → فتح Dashboard.
- Expected: رؤية counters للمستخدمين، الإيرادات، استخدام credits، عدد jobs.[^17_13][^17_14]
- Priority: Medium.

8) UI – تبديل اللغة

- Steps: من أي صفحة → تغيير اللغة إلى العربية/الإنجليزية.
- Expected: تغيير النصوص الرئيسية، الحفاظ على الحالة، عدم كسر التصميم.[^17_5]
- Priority: Medium.

(يمكنك توسيع القائمة لتشمل عشرات الحالات عبر نفس النمط.)

## Automation Scripts (Starter)

- API Tests (pytest + requests أو pytest + Playwright APIRequestContext):
    - test_auth.py: register/login/me.
    - test_credits.py: استعلام plans، إنشاء checkout session (Stripe Test API مع مفاتيح اختبار).[^17_7][^17_4]
    - test_jobs.py: إنشاء job بالرصيد الكافي/غير الكافي، التحقق من الحالة بعد mock استجابة kie.ai.[^17_2][^17_7]
- UI Tests (Playwright):
    - auth.spec.ts: sign up, login, logout.[^17_8][^17_5]
    - credits.spec.ts: شراء رصيد في Test Mode (Stripe Checkout في sandbox).[^17_3][^17_6]
    - jobs.spec.ts: سيناريو end-to-end لتوليد فيديو/صورة مع استخدام API mocking لطلبات kie.ai.[^17_7][^17_5]

مثال Playwright API test (فكرة):

```ts
test('create video job with enough credits', async ({ request }) => {
  // 1) login via API
  // 2) call POST /api/v1/jobs مع payload صالح
  // 3) توقع status 201 وحقل status = 'pending'
});
```


## Bug Tickets (Template)

كل فشل آلي → يولّد تذكرة فيها:

- Title: “[Video Job] رصيد كافٍ لكن الحالة لا تتغير إلى done”
- Steps to Reproduce:

1) تسجيل الدخول كمستخدم X
2) التأكد من وجود 50 credit
3) إنشاء job فيديو
4) الانتظار 5 دقائق
- Expected: status=done، وجود output_url، خصم credits.
- Actual: status تبقى pending، لا يوجد output.
- Severity: High
- Env: Staging, Backend SHA, Frontend SHA, Stripe Test, kie.ai sandbox.[^17_4][^17_2]


## Test Report \& Documentation

- تقرير بعد كل Run في CI:
    - عدد الحالات: Passed/Failed/Skipped.
    - تغطية تقريبية حسب الملفات (Coverage).[^17_8][^17_5]
- Documentation:
    - ملف QA-README:
        - كيف تشغّل pytest محليًا (API).
        - كيف تشغّل Playwright (UI) مع config للبيئة (BASE_URL، مفاتيح الاختبار لـStripe/kie.ai).[^17_4][^17_5][^17_7]
        - كيف تُحدّث حالات الاختبار عند إضافة Endpoint جديد.

هذه الخطة تعطيك أساس قوي لـQA يمكنك بناؤه داخل مشروعك (NestJS + Next.js + Stripe + kie.ai)، ومع الوقت تضيف Performance وLoad tests إذا احتجت.
<span style="display:none">[^17_15][^17_16][^17_17][^17_18][^17_19][^17_20][^17_21][^17_22][^17_23][^17_24][^17_25][^17_26][^17_27][^17_28][^17_29]</span>

<div align="center">⁂</div>

[^17_1]: https://mostaql.com/project/1184219-عمل-موقع-ذكاء-إصطناعي-إحترافي-video-صور-وتحويل-صور-لشخصيات-من-خلال-برومتات

[^17_2]: https://kie.ai

[^17_3]: https://docs.stripe.com/automated-testing

[^17_4]: https://docs.stripe.com/testing-use-cases

[^17_5]: https://playwright.dev/docs/best-practices

[^17_6]: https://docs.stripe.com/testing/overview

[^17_7]: https://playwright.dev/python/docs/api-testing

[^17_8]: https://betterstack.com/community/guides/testing/playwright-best-practices/

[^17_9]: https://kie.ai/market

[^17_10]: https://docs.stripe.com/billing/subscriptions/usage-based/use-cases/credits-based-pricing-model

[^17_11]: https://stripe.com/en-jp/resources/more/what-is-a-credits-based-subscription-model-and-how-does-it-work

[^17_12]: https://academy.hsoub.com/programming/general/ما-أنواع-الأخطاء-التي-تظهر-على-موقع-إلكتروني،-وكيف-نتعامل-معها؟-r2417/

[^17_13]: https://kie.ai/changelog

[^17_14]: https://stripe.com/resources/more/credits-pricing-models-for-scaling-businesses-explained

[^17_15]: https://mostaql.com/project/1184219-عمل-موقع-ذكاء-إصطناعي-إحترافي-video-صور-وتحويل-صور-لشخصيات-من-خلال-برومتات?deal_id=9436356\#message9946538

[^17_16]: https://www.synthesia.io

[^17_17]: https://www.youtube.com/watch?v=tXpg0wFy8Oc

[^17_18]: https://www.heygen.com/blog/11-best-ai-avatar-generator-platform-for-hr-training-videos-2025-tested-reviewed

[^17_19]: https://dev.to/simli_ai/how-to-create-real-time-ai-video-avatar-in-7-minutes-2i29

[^17_20]: https://www.vidyard.com/blog/ai-avatar-tools/

[^17_21]: https://www.gov.uk/algorithmic-transparency-records/standards-and-testing-agency-colossyan-ai-for-voiceovers-and-videos

[^17_22]: https://zeely.ai/blog/best-ai-avatar-generators/

[^17_23]: https://docs.codat.io/integrations/commerce/stripe/test-stripe

[^17_24]: https://www.aistudios.com

[^17_25]: https://www.reddit.com/r/softwaretesting/comments/1o32go1/playwright_api_testing_best_practices/

[^17_26]: https://docs.kore.ai/xo/app-settings/integrations/actions/stripe/using-the-stripe-action-templates/

[^17_27]: https://www.twilio.com/en-us/blog/build-real-time-video-ai-avatar

[^17_28]: https://playwrightsolutions.com/the-definitive-guide-to-api-test-automation-with-playwright-part-12-best-practices/

[^17_29]: https://testomat.io/blog/playwright-api-testing-comprehensive-guide-with-examples/

